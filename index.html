import React, { useState, useEffect } from 'react';
import { Share2, Copy, Check, TrendingUp, Gamepad2, CreditCard, BarChart3, MessageSquare, Zap } from 'lucide-react';

export default function MoneySharePage() {
  const [copied, setCopied] = useState(false);
  const [shares, setShares] = useState(0);
  const [earnings, setEarnings] = useState(0);
  const siteUrl = "https://tutu-eta.vercel.app/";

  useEffect(() => {
    const loadStats = async () => {
      try {
        const result = await window.storage.get('share_stats');
        if (result) {
          const stats = JSON.parse(result.value);
          setShares(stats.shares || 0);
        }
      } catch (error) {
        setShares(0);
      }
    };
    loadStats();

    const timer = setInterval(() => {
      setEarnings(prev => (prev + 1) % 10000);
    }, 100);
    return () => clearInterval(timer);
  }, []);

  const incrementShares = async () => {
    const newShares = shares + 1;
    setShares(newShares);
    try {
      await window.storage.set('share_stats', JSON.stringify({ shares: newShares }));
    } catch (error) {
      console.log('Could not save stats');
    }
  };

  const shareMessages = {
    default: "ðŸ”¥ DÃ©couvre comment gagner de l'argent en ligne facilement ! Jeux, cashback, paris sportifs, sondages... ðŸ’°",
    whatsapp: "Hey ! ðŸ¤‘ J'ai trouvÃ© un site de ouf pour gagner de l'argent : jeux, cashback, paris sportifs et sondages ! Check Ã§a :",
    twitter: "ðŸ’¸ Gagner de l'argent en ligne c'est possible ! Jeux ðŸŽ® Cashback ðŸ’³ Paris sportifs âš½ Sondages ðŸ“Š",
    facebook: "ðŸš€ Tu veux arrondir tes fins de mois ? DÃ©couvre plein de faÃ§ons de gagner de l'argent en ligne : jeux, cashback, paris sportifs, sondages et plus !",
  };

  const copyToClipboard = () => {
    navigator.clipboard.writeText(siteUrl);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  const handleShare = (platform) => {
    incrementShares();
    let shareUrl = '';
    
    switch(platform) {
      case 'facebook':
        shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(siteUrl)}`;
        break;
      case 'twitter':
        shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareMessages.twitter)}&url=${encodeURIComponent(siteUrl)}`;
        break;
      case 'whatsapp':
        shareUrl = `https://wa.me/?text=${encodeURIComponent(shareMessages.whatsapp + ' ' + siteUrl)}`;
        break;
      case 'telegram':
        shareUrl = `https://t.me/share/url?url=${encodeURIComponent(siteUrl)}&text=${encodeURIComponent(shareMessages.default)}`;
        break;
      case 'linkedin':
        shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(siteUrl)}`;
        break;
    }
    
    window.open(shareUrl, '_blank', 'width=600,height=400');
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white overflow-hidden">
      {/* Animated Background */}
      <div className="absolute inset-0 overflow-hidden pointer-events-none">
        <div className="absolute w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse -top-20 -left-20"></div>
        <div className="absolute w-96 h-96 bg-yellow-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse top-40 right-20 animation-delay-2000"></div>
        <div className="absolute w-96 h-96 bg-cyan-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse -bottom-20 left-40 animation-delay-4000"></div>
      </div>

      <div className="relative max-w-4xl mx-auto px-4 py-8">
        {/* Header avec stats */}
        <div className="text-center mb-8">
          <div className="inline-flex items-center gap-2 bg-gradient-to-r from-yellow-400 to-orange-500 text-black px-6 py-2 rounded-full text-sm font-bold mb-4 animate-bounce">
            <Zap className="w-4 h-4" />
            100% GRATUIT
          </div>
          <h1 className="text-5xl md:text-7xl font-black mb-4 bg-gradient-to-r from-yellow-300 via-pink-300 to-purple-300 bg-clip-text text-transparent animate-pulse">
            Gagne de l'Argent
          </h1>
          <p className="text-2xl md:text-3xl font-bold text-cyan-300">
            En Ligne Facilement ! ðŸ’°
          </p>
        </div>

        {/* Earnings Counter */}
        <div className="bg-black/40 backdrop-blur-lg rounded-3xl p-6 mb-8 border-2 border-purple-500 shadow-2xl">
          <div className="text-center">
            <p className="text-gray-300 mb-2">Gains potentiels aujourd'hui</p>
            <p className="text-5xl font-black text-transparent bg-gradient-to-r from-green-400 to-emerald-500 bg-clip-text">
              {earnings.toString().padStart(4, '0')}â‚¬+
            </p>
          </div>
        </div>

        {/* Features Grid */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
          <div className="bg-gradient-to-br from-purple-600 to-pink-600 rounded-2xl p-4 text-center transform hover:scale-105 transition-transform">
            <Gamepad2 className="w-8 h-8 mx-auto mb-2" />
            <p className="font-bold text-sm">Jeux</p>
          </div>
          <div className="bg-gradient-to-br from-blue-600 to-cyan-600 rounded-2xl p-4 text-center transform hover:scale-105 transition-transform">
            <CreditCard className="w-8 h-8 mx-auto mb-2" />
            <p className="font-bold text-sm">Cashback</p>
          </div>
          <div className="bg-gradient-to-br from-green-600 to-emerald-600 rounded-2xl p-4 text-center transform hover:scale-105 transition-transform">
            <TrendingUp className="w-8 h-8 mx-auto mb-2" />
            <p className="font-bold text-sm">Paris Sportifs</p>
          </div>
          <div className="bg-gradient-to-br from-orange-600 to-yellow-600 rounded-2xl p-4 text-center transform hover:scale-105 transition-transform">
            <MessageSquare className="w-8 h-8 mx-auto mb-2" />
            <p className="font-bold text-sm">Sondages</p>
          </div>
        </div>

        {/* Main CTA */}
        <div className="bg-gradient-to-r from-pink-600 via-purple-600 to-indigo-600 rounded-3xl p-8 mb-8 shadow-2xl transform hover:scale-105 transition-transform">
          <h2 className="text-3xl font-black mb-4 text-center">ðŸ”¥ Partage et Gagne Plus ! ðŸ”¥</h2>
          <p className="text-center mb-6 text-lg">Plus tu partages, plus tu multiplies tes chances de gains !</p>
          
          {/* Share Buttons */}
          <div className="grid grid-cols-2 md:grid-cols-3 gap-3 mb-6">
            <button
              onClick={() => handleShare('facebook')}
              className="bg-blue-600 hover:bg-blue-700 py-3 px-4 rounded-xl font-bold transition-all transform hover:scale-110 flex items-center justify-center gap-2"
            >
              <Share2 className="w-5 h-5" />
              Facebook
            </button>
            <button
              onClick={() => handleShare('twitter')}
              className="bg-sky-500 hover:bg-sky-600 py-3 px-4 rounded-xl font-bold transition-all transform hover:scale-110 flex items-center justify-center gap-2"
            >
              <Share2 className="w-5 h-5" />
              Twitter
            </button>
            <button
              onClick={() => handleShare('whatsapp')}
              className="bg-green-500 hover:bg-green-600 py-3 px-4 rounded-xl font-bold transition-all transform hover:scale-110 flex items-center justify-center gap-2"
            >
              <Share2 className="w-5 h-5" />
              WhatsApp
            </button>
            <button
              onClick={() => handleShare('telegram')}
              className="bg-blue-400 hover:bg-blue-500 py-3 px-4 rounded-xl font-bold transition-all transform hover:scale-110 flex items-center justify-center gap-2"
            >
              <Share2 className="w-5 h-5" />
              Telegram
            </button>
            <button
              onClick={() => handleShare('linkedin')}
              className="bg-blue-700 hover:bg-blue-800 py-3 px-4 rounded-xl font-bold transition-all transform hover:scale-110 flex items-center justify-center gap-2"
            >
              <Share2 className="w-5 h-5" />
              LinkedIn
            </button>
            <button
              onClick={copyToClipboard}
              className="bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 py-3 px-4 rounded-xl font-bold transition-all transform hover:scale-110 flex items-center justify-center gap-2"
            >
              {copied ? <Check className="w-5 h-5" /> : <Copy className="w-5 h-5" />}
              {copied ? 'CopiÃ© !' : 'Copier'}
            </button>
          </div>

          {/* Link Display */}
          <div className="bg-black/30 rounded-xl p-4 text-center break-all">
            <p className="text-sm text-gray-300 mb-1">Ton lien de partage :</p>
            <p className="font-mono text-yellow-300">{siteUrl}</p>
          </div>
        </div>

        {/* Stats */}
        <div className="bg-black/40 backdrop-blur-lg rounded-3xl p-6 mb-8 border border-purple-500">
          <div className="flex items-center justify-center gap-4">
            <BarChart3 className="w-8 h-8 text-green-400" />
            <div className="text-center">
              <p className="text-3xl font-black text-green-400">{shares}</p>
              <p className="text-sm text-gray-300">Partages aujourd'hui</p>
            </div>
          </div>
        </div>

        {/* QR Code Section */}
        <div className="bg-white rounded-3xl p-6 text-center">
          <h3 className="text-2xl font-black text-gray-800 mb-4">ðŸ“± Scanne & Partage</h3>
          <div className="bg-gray-100 p-4 rounded-xl inline-block">
            <img 
              src={`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(siteUrl)}`}
              alt="QR Code"
              className="w-48 h-48"
            />
          </div>
          <p className="text-gray-600 mt-4 text-sm">Montre ce QR code Ã  tes potes !</p>
        </div>

        {/* Footer CTA */}
        <div className="text-center mt-8">
          <a
            href={siteUrl}
            target="_blank"
            rel="noopener noreferrer"
            className="inline-block bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-black text-xl py-4 px-8 rounded-full transition-all transform hover:scale-110 shadow-2xl"
          >
            ðŸš€ Commence Ã  Gagner Maintenant !
          </a>
        </div>
      </div>
    </div>
  );
}
